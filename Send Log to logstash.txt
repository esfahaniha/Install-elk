#!/bin/bash

LOG_FILE="/path/to/your/logfile.log"
LOGSTASH_URL="http://192.168.11.130:5044"

# Extract the application name from the log file name (without path)
APP_NAME=$(basename "$LOG_FILE")

# Use tail -F to follow the log file and process new lines as they are added
tail -F "$LOG_FILE" | while read -r line; do
  # Get the hostname of the server
  HOSTNAME=$(hostname)

  # Send each new line to Logstash with the extracted application name
  curl -X POST "$LOGSTASH_URL" -H "Content-Type: application/json" -d'
  {
    "@timestamp": "'$(date --utc +%Y-%m-%dT%H:%M:%S.%3NZ)'",
    "log": "'"$line"'",
    "host": "'"$HOSTNAME"'",
    "application": "'"$APP_NAME"'",
    "level": "info"
  }'
done
